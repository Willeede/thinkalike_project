<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThinkAlike Documentation</title>
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            display: flex;
            min-height: 100vh;
            background-color: #000;
            color: #eee;
        }
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: #FFC300;
        }
        a {
            color: #F86B03;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
            color: #FF8C00;
        }
        #sidebar {
            width: 250px;
            background-color: #212121;
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid #444;
            height: 100vh;
            position: sticky;
            top: 0;
        }
        #content {
            flex: 1;
            padding: 20px;
        }
        .nav-link {
            cursor: pointer;
            padding: .5rem 1rem;
            color: #F86B03;
            display: block;
            text-decoration: none;
        }
        .nav-link:hover {
            background-color: #333;
            color: #FF8C00;
        }
        .nav-link.active {
            background-color: #F86B03;
            color: white;
        }
        pre {
            background-color: #333;
            color: #eee;
            padding: 10px;
            border: 1px solid #666;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
        }
        .mermaid {
            overflow: auto;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>

<nav id="sidebar">
    <h1>ThinkAlike Project Documentation</h1>
    <ul class="nav flex-column" id="nav-links"></ul>
</nav>

<main id="content" class="markdown-body"></main>

<script>
    $(document).ready(function() {
        marked.setOptions({
            gfm: true,
            breaks: false,
            sanitize: false,
            smartLists: true,
            smartypants: false
        });

        const files = [
            { file: "onboarding_guide.md", title: "Onboarding" },
            { file: "quickstart_guide.md", title: "Quickstart" },
            { file: "style_guide.md", title: "Style" },
            { file: "CODE_OF_CONDUCT.md", title: "Code Of Conduct" },
            { file: "CONTRIBUTING.md", title: "Contributing" },
            { file: "INSTALLATION.md", title: "Installation" },
            { file: "ThinkAlike_Architectural_Design_Specifications.md", title: "Architectural Design Specifications" },
            { file: "ThinkAlike_Data_Model_Schema.md", title: "Data Model Schema" },
            { file: "ThinkAlike_Security_and_Privacy_Implementation_Plan.md", title: "Security & Privacy Implementation Plan" },
            { file: "ThinkAlike_Testing_and_Validation_Plan.md", title: "Testing & Validation Plan" },
            { file: "ThinkAlike__MVP_Implementation_Guide.md", title: "MVP Implementation" },
            { file: "funding_model.md", title: "Funding Model" },
            { file: "project_overview.md", title: "Project Overview" },
            { file: "ai_driven_workflow.md", title: "AI Driven Workflow" },
            { file: "code_documentation_template.md", title: "Code Documentation Template" },
            { file: "API_schema.json", title: "API Schema" },
            { file: "DEPLOYMENT_RENDER.md", title: "Deployment to Render" },
            { file: "TROUBLESHOOTING.md", title: "Troubleshooting" },
            { file: "thinkalike_notebook.html", title: "Project Notebook" }
        ];

        function generateNavLinks() {
            const navLinks = files.map(item => `
                <li class="nav-item">
                    <a class="nav-link" data-file="${item.file}" href="#${item.file}">
                        ${item.title}
                    </a>
                </li>
            `).join('');
            $('#nav-links').html(navLinks);

            // Click handler for sidebar links
            $('.nav-link').click(function(e) {
                e.preventDefault();
                const file = $(this).data('file');
                setActiveLink(file);
                loadContent(file);
            });
        }

        function setActiveLink(file) {
            $('.nav-link').removeClass('active');
            $(`.nav-link[data-file="${file}"]`).addClass('active');
        }

        function fileExists(file) {
            try {
                let request = new XMLHttpRequest();
                request.open("HEAD", file, false);
                request.send();
                return request.status !== 404;
            } catch (error) {
                console.warn("Failed to check file existence:", file);
                return false;
            }
        }

        function loadContent(file) {
            if (!fileExists(file)) {
                console.error(`File not found: ${file}`);
                $('#content').html(`<p>File not found: ${file}</p>`);
                return;
            }
            $.ajax({
                url: file,
                dataType: 'text',
                success: function(data) {
                    console.log(`Loading file: ${file}`);
                    if (file.endsWith('.json')) {
                        try {
                            const jsonData = JSON.parse(data);
                            const formattedJSON = JSON.stringify(jsonData, null, 2);
                            $('#content').html(`<pre><code class="language-json">${formattedJSON}</code></pre>`);
                            hljs.highlightAll();
                        } catch (ex) {
                            console.error(`JSON parse error (${file}):`, ex);
                            $('#content').html(`<p>Error parsing JSON: ${file}</p>`);
                        }
                    } else if (file.endsWith('.html')) {
                        $('#content').html(data);
                    } else {
                        const htmlContent = marked.parse(data);
                        $('#content').html(htmlContent);
                        setTimeout(() => {
                            mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
                        }, 300);
                    }
                    setActiveLink(file);
                },
                error: function(xhr) {
                    console.error(`Error loading ${file}:`, xhr.status, xhr.statusText);
                    $('#content').html(`<p>Error: ${xhr.status} ${xhr.statusText}</p>`);
                }
            });
        }

        generateNavLinks();

        // Function to set active link on initial load and hash change
        function updateActiveLink() {
            const hash = window.location.hash.substring(1);
            setActiveLink(hash);
            if (hash) {
                loadContent(hash);
            } else {
                loadContent('onboarding_guide.md'); // Default content
                setActiveLink('onboarding_guide.md');
            }
        }

        // Listen for hash changes
        $(window).on('hashchange', updateActiveLink);

        // Initial load
        updateActiveLink();
        hljs.highlightAll();
    });
</script>

</body>
</html>
